# PicoCTF 2022
- Challenge: basic-file-exploit
- Category: Binary Exploitation
- Points: 100
- Author: Will Hong

## Description
The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!
Connect to the program with netcat:
$ nc saturn.picoctf.net 49700
The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/539/program-redacted.c).

## Solution
The software running on the server gives the user 3 options:
1. Enter a phrase into the database
2. Echo (read) a phrase in the database
3. Exit the program

The source code, on line 144, is outputting the flag to the user. The condition for the flag to be outputted is the following:
`if ((entry_number = strtol(entry, NULL, 10)) == 0)`

![Vulnerable piece of source code](https://imgur.com/xFgrqqC.png)

The `entry_number` variable is the user input upon selecting option 2 (echoing a prhase). Therefore, if the user select option 0 after option 2, the flag will be outputted.
However, in order to read any data, some data has to be inserted first. So insert any data using option 1 and then select option 2 and ask for data number 0.

![Solution](https://imgur.com/IxajpHb.png)

## Commands issued
```bash
nc saturn.picoctf.net 49700
1
test
4
2
0
```
